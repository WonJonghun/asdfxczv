<html class="no-js css-menubar" lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <meta name="description" content="bootstrap admin template">
    <meta name="author" content="Goback">

    <title></title>
    <!--     Fonts and icons     -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,1,0" />
    <!-- Nucleo Icons -->
    <!-- <link href="css/chart/nucleo-icons.css" rel="stylesheet" />
    <link href="css/chart/nucleo-svg.css" rel="stylesheet" /> -->
    <!-- Font Awesome Icons -->
    <!-- <script src="https://kit.fontawesome.com/42d5adcbca.js" crossorigin="anonymous"></script>
    <link href="css/chart/nucleo-svg.css" rel="stylesheet" /> -->
    <!-- CSS Files -->
    <!-- <link id="pagestyle" href="css/chart/argon-dashboard.css?v=2.0.4" rel="stylesheet" />
    <link rel="stylesheet" href="css/chart/style.css">

    <link rel="stylesheet" href="css/fontello.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
        integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="stylesheet" href="css/design.css">
    <link rel="stylesheet" href="css/sidemenu.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.8.2/css/all.min.css" /> -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="css/menubar.css">
    <link rel="stylesheet" href="css/page.css">
    <link rel="stylesheet" href="css/site.css">
    <link rel="stylesheet" href="css/component.css">

</head>

<body class="animation">
    <div class="header">
        <div class="logo">
            <img class="brand-logo" src="images/goback_logo.png" alt="">
            <span class="brand-text">GOBACK</span>
        </div>
    </div>
    <div class="site-menubar">
        <div class="site-menubar-body scrollable scrollable-inverse is-enabled scrollable-vertical hoverscorll-disabled"
            style="position: relative;">
            <!-- <div class="scrollable-container" style="height: 646.984px; width: 277px;">
                <div class="scrollable-content" style="width: 260px;"> -->
                    <ul class="site-menu">
                        <li class="site-menu-item">
                            <a href="/">
                                <span class="material-symbols-outlined site-menu-icon">pie_chart</span>
                                <span class="site-menu-title">Overview</span>
                            </a>
                        </li>
                        <li class="site-menu-item">
                            <a href="/manageStatic">
                                <span class="material-symbols-outlined site-menu-icon">camera</span>
                                <span class="site-menu-title">Manage</span>
                            </a>
                        </li>
                        <li class="site-menu-item">
                            <a href="/staticReport">
                                <span class="material-symbols-outlined site-menu-icon">library_books</span>
                                <span class="site-menu-title">Report</span>
                                <!-- <span class="material-symbols-outlined site-menu-arrow">chevron_right</span> -->
                            </a>
                        </li>
                        <li class="site-menu-item open">
                            <a href="/buildingSetting">
                                <span class="material-symbols-outlined site-menu-icon">settings</span>
                                <span class="site-menu-title">Settings</span>
                            </a>
                        </li>
                    </ul>
                <!-- </div>
            </div> -->
            <!-- <div class="scrollable-bar scrollable-bar-vertical scrollable-bar-hide" draggable="false"><div class="scrollable-bar-handle" style="height: 529.364px;"></div></div></div> -->
        </div>
    </div>

    <div class="page">
        <!-- <div class="page-content container-fluid"> -->
        <div class="page-header">
            <h1 class="page-title">Settings</h1>
        </div>
        <div class="page-content">
            <div class="col-12 top-btn-group">
                <a href="/buildingSetting" class="btn btn-sm btn-raised btn-primary btn-block">건물 설정</a>
                <a href="/panelSetting" class="btn btn-sm btn-raised btn-primary btn-outline btn-block">반 설정</a>
                <a href="/staticCamSetting" class="btn btn-sm btn-raised btn-primary btn-outline btn-block">고정형 카메라 설정</a>
            </div>

            <div class="row">
                <div class="col-lg-7 col-xxl-7 col-sm-12">
                    <div class="card card-shadow card-responsive">
                        <div class="card-block p-0">
                            <div id="map" style="height: 600px;"></div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-5 col-xxl-5 col-sm-12" style="height: 600px;">
                    <div class="card card-shadow card-responsive">
                        <div class="card-block p-0">
                            <h5 class="p-30 blue-grey-700 text-center m-0 card-title">건물 위치를 클릭하고 건물명과 기관명을 입력해주세요.</h5>
                            <div class="px-30 pb-30 col-12"  style="height: 520px; line-height: 60px;">
                                <div style="padding: 60px 10px; height: calc(100% - 60px);">
                                    <div class="col-12 row middle">
                                        <p class="col-2">기관명 : </p>
                                        <div class="col-10"><input type="text" class="form-control round" name="" id="input_org"></div>                                        
                                    </div>
                                    <div class="col-12 row middle">
                                        <p class="col-2">건물명 : </p>
                                        <div class="col-10"><input type="text" class="form-control round" name="" id="input_build"></div>                                        
                                    </div>
                                    <div class="col-12 row middle">
                                        <p class="col-2">위도 : </p>
                                        <div class="col-10"><input type="text" class="form-control round" name="" id="input_lat"></div>                                        
                                    </div>
                                    <div class="col-12 row middle">
                                        <p class="col-2">경도 : </p>
                                        <div class="col-10"><input type="text" class="form-control round" name="" id="input_long"></div>                                        
                                    </div>
                                    <input id="input_id" type="hidden">
                                </div>
                                <div class="col-12 text-center">
                                    <button type="button" id="btn_save" class="btn btn-sm btn-raised btn-primary btn-block">저장</button>
                                    <button type="button" id="btn_update" class="btn btn-sm btn-raised btn-primary btn-block display-none">수정</button>
                                    <button type="button" id="btn_del" class="btn btn-sm btn-raised btn-primary btn-outline btn-block display-none">삭제</button>
                                    <button type="button" id="btn_center" class="btn btn-sm btn-raised btn-primary btn-outline btn-block">중심 좌표 설정</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    <script src="/js/jquery.js"></script>
    <!-- <script src="/js/site.js"></script> -->
    <script src="/js/menu.js"></script>
    <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=	4f938fad32a965f67dd8a32c6ad2ff7a"></script>
    <script src="/js/mapSetting.js"></script>
    <script type="text/javascript">
        $('#btn_save').on('click', function() {
            $.ajax({
                type: "POST",
                url: "buildingSetting/check_buildingName",
                async: false,
                dataType: "json",
                data: {
                    name: $('#input_build').val()
                },
                success: function (data) {
                    console.log(data)
                    if(data.length == 0) {
                        $.ajax({
                            type: "POST",
                            url: "buildingSetting/insert_building",
                            async: false,
                            dataType: "json",
                            data: {
                                org: $('#input_org').val(),
                                name: $('#input_build').val(),
                                lat: $('#input_lat').val(),
                                long: $('#input_long').val()
                            },
                            success: function (data) {
                                alert("저장 성공");
                                location.href= "/buildingSetting"
                            },
                            error: function (e) {
                                console.info(e);
                                console.info("Error");
                            },
                            done: function (e) {
                                console.info("DONE");
                            }
                        })
                    } else {
                        alert("이름이 중복됩니다.")
                    }

                },
                error: function (e) {
                    console.info(e);
                    console.info("Error");
                },
                done: function (e) {
                    console.info("DONE");
                }
            })
        })

        $('#btn_update').on('click', function() {
            $.ajax({
                type: "POST",
                url: "buildingSetting/update_building",
                async: false,
                dataType: "json",
                data: {
                    id: $('#input_id').val(),
                    org: $('#input_org').val(),
                    name: $('#input_build').val(),
                    lat: $('#input_lat').val(),
                    long: $('#input_long').val()
                },
                success: function (data) {
                    alert("저장 성공");
                    location.href= "/buildingSetting"
                },
                error: function (e) {
                    console.info(e);
                    console.info("Error");
                },
                done: function (e) {
                    console.info("DONE");
                }
            })
        })

        $('#btn_del').on('click', function() {
            $.ajax({
                type: "POST",
                url: "buildingSetting/delete_building",
                async: false,
                dataType: "json",
                data: {
                    id: $('#input_id').val()
                },
                success: function (data) {
                    alert("저장 성공");
                    location.href= "/buildingSetting"
                },
                error: function (e) {
                    console.info(e);
                    console.info("Error");
                },
                done: function (e) {
                    console.info("DONE");
                }
            })
        })

        $('#btn_center').on('click', function() {
            $.ajax({
                type: "POST",
                url: "buildingSetting/update_center",
                async: false,
                dataType: "json",
                data: {
                    lat: $('#input_lat').val(),
                    long: $('#input_long').val()
                },
                success: function (data) {
                    alert("저장 성공");
                    var moveLatLon = new kakao.maps.LatLng($('#input_lat').val(), $('#input_long').val());
                    map.panTo(moveLatLon); 
                },
                error: function (e) {
                    console.info(e);
                    console.info("Error");
                },
                done: function (e) {
                    console.info("DONE");
                }
            })
        })
    </script>
</body>

</html>